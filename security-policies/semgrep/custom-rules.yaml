rules:
  - id: hardcoded-secret
    patterns:
      - pattern-either:
          - pattern: password = "..."
          - pattern: secret = "..."
          - pattern: api_key = "..."
          - pattern: token = "..."
    message: Potential hardcoded secret detected
    severity: ERROR
    languages: [python, javascript, go]
    metadata:
      cwe: 'CWE-798: Use of Hard-coded Credentials'
      owasp: 'A07:2021 - Identification and Authentication Failures'

  - id: sql-injection
    patterns:
      - pattern: execute("SELECT * FROM users WHERE id = " + $X)
      - pattern: cursor.execute("... " + $VAR + " ...")
    message: Potential SQL injection vulnerability
    severity: ERROR
    languages: [python]
    metadata:
      cwe: 'CWE-89: SQL Injection'
      owasp: 'A03:2021 - Injection'

  - id: command-injection
    patterns:
      - pattern: os.system($X)
      - pattern: subprocess.call($X, shell=True)
      - pattern: subprocess.run($X, shell=True)
    message: Potential command injection - avoid shell=True
    severity: WARNING
    languages: [python]
    metadata:
      cwe: 'CWE-78: OS Command Injection'
      owasp: 'A03:2021 - Injection'

  - id: weak-crypto
    patterns:
      - pattern: hashlib.md5(...)
      - pattern: hashlib.sha1(...)
    message: Weak cryptographic algorithm - use SHA256 or better
    severity: WARNING
    languages: [python]
    metadata:
      cwe: 'CWE-327: Use of a Broken or Risky Cryptographic Algorithm'
      owasp: 'A02:2021 - Cryptographic Failures'

  - id: debug-mode
    patterns:
      - pattern: DEBUG = True
      - pattern: debug=True
    message: Debug mode enabled - should be False in production
    severity: WARNING
    languages: [python]
    metadata:
      cwe: 'CWE-489: Active Debug Code'

  - id: unsafe-yaml-load
    patterns:
      - pattern: yaml.load($X)
    message: Unsafe YAML loading - use yaml.safe_load() instead
    severity: ERROR
    languages: [python]
    metadata:
      cwe: 'CWE-502: Deserialization of Untrusted Data'
      owasp: 'A08:2021 - Software and Data Integrity Failures'
